0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 20 20 63 68 61 72 20 73 74 72 69 6E 67 20 5B  .  char string [
0x0000000000000070: 31 37 5D 3B 0A 20 20 69 6E 74 20 69 20 3D 30 3B  17];.  int i =0;
0x0000000000000080: 0A 20 20 69 6E 74 20 6B 20 3D 20 30 3B 0A 20 20  .  int k = 0;.  
0x0000000000000090: 69 6E 74 20 63 6F 75 6E 74 65 72 20 3D 20 31 36  int counter = 16
0x00000000000000A0: 3B 0A 20 20 46 49 4C 45 20 2A 20 66 64 20 3D 20  ;.  FILE * fd = 
0x00000000000000B0: 73 74 64 6F 75 74 3B 0A 20 20 0A 20 20 20 20 20  stdout;.  .     
0x00000000000000C0: 20 63 68 61 72 20 2A 20 78 20 3D 20 30 78 30 30   char * x = 0x00
0x00000000000000D0: 30 30 30 30 30 30 30 30 30 30 30 30 30 30 3B 0A  00000000000000;.
0x00000000000000E0: 20 20 0A 20 20 66 70 72 69 6E 74 66 28 66 64 2C    .  fprintf(fd,
0x00000000000000F0: 20 22 30 78 25 30 31 36 6C 58 3A 20 22 2C 20 28   "0x%016lX: ", (
0x0000000000000100: 75 6E 73 69 67 6E 65 64 20 6C 6F 6E 67 29 20 78  unsigned long) x
0x0000000000000110: 29 3B 0A 20 20 66 6F 72 20 28 69 3D 30 3B 20 69  );.  for (i=0; i
0x0000000000000120: 20 3C 20 6C 65 6E 3B 20 69 2B 2B 29 20 7B 0A 0A   < len; i++) {..
0x0000000000000130: 20 20 20 20 69 66 20 28 20 69 20 25 20 31 36 20      if ( i % 16 
0x0000000000000140: 3D 3D 20 30 20 26 26 20 69 20 21 3D 20 30 29 7B  == 0 && i != 0){
0x0000000000000150: 0A 20 20 20 20 20 20 73 74 72 69 6E 67 5B 6B 5D  .      string[k]
0x0000000000000160: 20 3D 20 27 5C 30 27 3B 0A 20 20 20 20 20 20 66   = '\0';.      f
0x0000000000000170: 70 72 69 6E 74 66 28 66 64 2C 20 22 20 25 73 22  printf(fd, " %s"
0x0000000000000180: 2C 20 73 74 72 69 6E 67 29 3B 0A 20 20 20 20 20  , string);.     
0x0000000000000190: 20 6B 3D 30 3B 0A 20 20 20 20 20 20 66 70 72 69   k=0;.      fpri
0x00000000000001A0: 6E 74 66 28 66 64 2C 22 5C 6E 22 29 3B 0A 0A 0A  ntf(fd,"\n");...
0x00000000000001B0: 20 20 20 20 20 20 66 70 72 69 6E 74 66 28 66 64        fprintf(fd
0x00000000000001C0: 2C 20 22 30 78 25 30 31 36 6C 58 3A 20 22 2C 20  , "0x%016lX: ", 
0x00000000000001D0: 28 75 6E 73 69 67 6E 65 64 20 6C 6F 6E 67 29 20  (unsigned long) 
0x00000000000001E0: 78 20 2B 20 63 6F 75 6E 74 65 72 29 3B 0A 20 20  x + counter);.  
0x00000000000001F0: 20 20 20 20 63 6F 75 6E 74 65 72 2B 3D 31 36 3B      counter+=16;
0x0000000000000200: 0A 20 20 20 20 7D 0A 0A 20 20 20 20 69 6E 74 20  .    }..    int 
0x0000000000000210: 63 20 3D 20 70 5B 69 5D 26 30 78 46 46 3B 20 2F  c = p[i]&0xFF; /
0x0000000000000220: 2F 20 47 65 74 20 76 61 6C 75 65 20 61 74 20 5B  / Get value at [
0x0000000000000230: 70 5D 2E 20 54 68 65 20 26 30 78 46 46 20 69 73  p]. The &0xFF is
0x0000000000000240: 20 74 6F 20 6D 61 6B 65 20 73 75 72 65 20 79 6F   to make sure yo
0x0000000000000250: 75 20 74 72 75 6E 63 61 74 65 20 74 6F 20 38 62  u truncate to 8b
0x0000000000000260: 69 74 73 20 6F 72 20 6F 6E 65 20 62 79 74 65 2E  its or one byte.
0x0000000000000270: 0A 20 20 20 20 69 66 20 28 63 3E 3D 33 32 20 26  .    if (c>=32 &
0x0000000000000280: 26 20 63 20 3C 20 31 32 37 29 7B 0A 20 20 20 20  & c < 127){.    
0x0000000000000290: 20 20 73 74 72 69 6E 67 5B 6B 5D 20 3D 20 70 5B    string[k] = p[
0x00000000000002A0: 69 5D 3B 0A 20 20 20 20 7D 0A 20 20 20 20 65 6C  i];.    }.    el
0x00000000000002B0: 73 65 7B 0A 20 20 20 20 20 20 73 74 72 69 6E 67  se{.      string
0x00000000000002C0: 5B 6B 5D 20 3D 20 27 2E 27 3B 0A 20 20 20 20 7D  [k] = '.';.    }
0x00000000000002D0: 0A 20 20 20 20 6B 2B 2B 3B 0A 20 20 20 20 2F 2F  .    k++;.    //
0x00000000000002E0: 20 50 72 69 6E 74 20 66 69 72 73 74 20 62 79 74   Print first byt
0x00000000000002F0: 65 20 61 73 20 68 65 78 61 64 65 63 69 6D 61 6C  e as hexadecimal
0x0000000000000300: 0A 20 20 20 20 66 70 72 69 6E 74 66 28 66 64 2C  .    fprintf(fd,
0x0000000000000310: 20 22 25 30 32 58 20 22 2C 20 63 29 3B 0A 20 20   "%02X ", c);.  
0x0000000000000320: 20 20 2F 2F 20 50 72 69 6E 74 20 66 69 72 73 74    // Print first
0x0000000000000330: 20 62 79 74 65 20 61 73 20 63 68 61 72 61 63 74   byte as charact
0x0000000000000340: 65 72 2E 20 4F 6E 6C 79 20 70 72 69 6E 74 20 63  er. Only print c
0x0000000000000350: 68 61 72 61 63 74 65 72 73 20 3E 3D 20 33 32 20  haracters >= 32 
0x0000000000000360: 74 68 61 74 20 61 72 65 20 74 68 65 20 70 72 69  that are the pri
0x0000000000000370: 6E 74 61 62 6C 65 20 63 68 61 72 61 63 74 65 72  ntable character
0x0000000000000380: 73 2E 0A 0A 20 20 7D 0A 0A 20 20 69 66 20 28 20  s...  }..  if ( 
0x0000000000000390: 69 20 25 20 31 36 20 3D 3D 20 30 20 26 26 20 69  i % 16 == 0 && i
0x00000000000003A0: 20 21 3D 20 30 29 7B 0A 20 20 20 20 73 74 72 69   != 0){.    stri
0x00000000000003B0: 6E 67 5B 6B 5D 20 3D 20 27 5C 30 27 3B 0A 20 20  ng[k] = '\0';.  
0x00000000000003C0: 20 20 66 70 72 69 6E 74 66 28 66 64 2C 20 22 20    fprintf(fd, " 
0x00000000000003D0: 25 73 22 2C 20 73 74 72 69 6E 67 29 3B 0A 20 20  %s", string);.  
0x00000000000003E0: 20 20 6B 3D 30 3B 0A 20 20 20 20 66 70 72 69 6E    k=0;.    fprin
0x00000000000003F0: 74 66 28 66 64 2C 22 5C 6E 22 29 3B 0A 0A 20 20  tf(fd,"\n");..  
0x0000000000000400: 20 20 63 6F 75 6E 74 65 72 2B 3D 31 36 3B 0A 20    counter+=16;. 
0x0000000000000410: 20 7D 0A 0A 20 20 69 66 20 28 6B 20 21 3D 30 29   }..  if (k !=0)
0x0000000000000420: 7B 0A 20 20 20 20 69 6E 74 20 6A 20 3D 20 30 3B  {.    int j = 0;
0x0000000000000430: 0A 20 20 20 20 73 74 72 69 6E 67 5B 6B 5D 20 3D  .    string[k] =
0x0000000000000440: 20 27 5C 30 27 3B 0A 20 20 20 20 66 6F 72 20 28   '\0';.    for (
0x0000000000000450: 6A 20 3D 20 6B 3B 20 6A 20 3C 20 31 36 3B 20 6A  j = k; j < 16; j
0x0000000000000460: 20 2B 2B 29 7B 0A 20 20 20 20 20 20 66 70 72 69   ++){.      fpri
0x0000000000000470: 6E 74 66 28 66 64 2C 20 22 20 20 20 22 29 3B 0A  ntf(fd, "   ");.
0x0000000000000480: 20 20 20 20 7D 0A 20 20 20 20 66 70 72 69 6E 74      }.    fprint
0x0000000000000490: 66 28 66 64 2C 20 22 20 25 73 5C 6E 22 2C 20 73  f(fd, " %s\n", s
0x00000000000004A0: 74 72 69 6E 67 29 3B 0A 20 20 7D 0A 7D 0A 0A 69  tring);.  }.}..i
0x00000000000004B0: 6E 74 20 6D 61 69 6E 28 69 6E 74 20 61 72 67 63  nt main(int argc
0x00000000000004C0: 2C 20 63 68 61 72 20 2A 2A 61 72 67 76 29 20 7B  , char **argv) {
0x00000000000004D0: 0A 20 20 0A 20 20 46 49 4C 45 20 2A 20 66 69 6E  .  .  FILE * fin
0x00000000000004E0: 20 3D 20 20 66 6F 70 65 6E 28 61 72 67 76 5B 31   =  fopen(argv[1
0x00000000000004F0: 5D 2C 22 72 22 29 3B 0A 20 20 69 66 28 66 69 6E  ],"r");.  if(fin
0x0000000000000500: 3D 3D 4E 55 4C 4C 29 7B 0A 20 20 20 20 70 72 69  ==NULL){.    pri
0x0000000000000510: 6E 74 66 28 22 45 72 72 6F 72 20 6F 70 65 6E 69  ntf("Error openi
0x0000000000000520: 6E 67 20 66 69 6C 65 20 5C 22 69 6E 76 61 6C 69  ng file \"invali
0x0000000000000530: 64 66 69 6C 65 5C 22 5C 6E 22 29 3B 0A 20 20 20  dfile\"\n");.   
0x0000000000000540: 20 65 78 69 74 28 31 29 3B 0A 20 20 7D 0A 20 20   exit(1);.  }.  
0x0000000000000550: 0A 20 20 66 73 65 65 6B 28 66 69 6E 2C 20 30 4C  .  fseek(fin, 0L
0x0000000000000560: 2C 20 53 45 45 4B 5F 45 4E 44 29 3B 0A 20 20 69  , SEEK_END);.  i
0x0000000000000570: 6E 74 20 66 69 6C 65 53 69 7A 65 20 3D 20 66 74  nt fileSize = ft
0x0000000000000580: 65 6C 6C 28 66 69 6E 29 3B 0A 20 20 66 73 65 65  ell(fin);.  fsee
0x0000000000000590: 6B 28 66 69 6E 2C 20 30 4C 2C 20 53 45 45 4B 5F  k(fin, 0L, SEEK_
0x00000000000005A0: 53 45 54 29 3B 0A 0A 20 20 63 68 61 72 20 2A 20  SET);..  char * 
0x00000000000005B0: 78 20 3D 20 28 63 68 61 72 2A 29 6D 61 6C 6C 6F  x = (char*)mallo
0x00000000000005C0: 63 28 66 69 6C 65 53 69 7A 65 29 3B 0A 20 20 0A  c(fileSize);.  .
0x00000000000005D0: 20 20 66 72 65 61 64 28 78 2C 31 2C 66 69 6C 65    fread(x,1,file
0x00000000000005E0: 53 69 7A 65 2C 66 69 6E 29 3B 0A 0A 20 20 69 6E  Size,fin);..  in
0x00000000000005F0: 74 20 6C 65 6E 20 3D 20 30 3B 0A 20 20 69 66 28  t len = 0;.  if(
0x0000000000000600: 61 72 67 63 3D 3D 33 29 7B 0A 20 20 20 20 69 66  argc==3){.    if
0x0000000000000610: 28 66 69 6C 65 53 69 7A 65 3C 61 74 6F 69 28 61  (fileSize<atoi(a
0x0000000000000620: 72 67 76 5B 32 5D 29 29 7B 0A 20 20 20 20 20 20  rgv[2])){.      
0x0000000000000630: 6C 65 6E 20 3D 20 66 69 6C 65 53 69 7A 65 3B 0A  len = fileSize;.
0x0000000000000640: 20 20 20 20 7D 0A 20 20 20 20 65 6C 73 65 7B 0A      }.    else{.
0x0000000000000650: 20 20 20 20 20 20 6C 65 6E 20 3D 20 61 74 6F 69        len = atoi
0x0000000000000660: 28 61 72 67 76 5B 32 5D 29 3B 0A 20 20 20 20 7D  (argv[2]);.    }
0x0000000000000670: 0A 20 20 7D 0A 20 20 65 6C 73 65 7B 0A 20 20 20  .  }.  else{.   
0x0000000000000680: 20 6C 65 6E 20 3D 20 66 69 6C 65 53 69 7A 65 3B   len = fileSize;
0x0000000000000690: 0A 20 20 7D 0A 0A 20 20 66 69 6C 65 64 75 6D 70  .  }..  filedump
0x00000000000006A0: 28 78 2C 6C 65 6E 29 3B 0A 7D 0A 0A 0A           (x,len);.}...
